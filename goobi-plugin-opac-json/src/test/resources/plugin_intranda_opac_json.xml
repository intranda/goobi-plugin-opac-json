<config_plugin>
	<config>
	
 <!-- Syntax: https://github.com/json-path/JsonPath#path-examples   -->

        <!-- check if field  /children/children/recordType with value 'item' exists -->
        <recordType field="$.children[?(@.itemCount &gt; 1)]"  docType="Volume" anchorType="MultiVolumeWork" />

        <recordType field="$.children[?(@.itemCount == 1)]" docType="Monograph" />
        <!-- check if "recordType": "archival_object" exists -->
        <recordType field="[?(@.['recordType']=='archival_object')]" docType="Monograph" />
        

<!-- default publication type if it cannot be detected. If missing or empty, no record will be created -->
       <defaultPublicationType>Monograph</defaultPublicationType>

        <!-- 
        metadata : name of the field in ruleset
        field: path to the field
        regularExpression: regex to manipulate the value
        docType: volume or anchor        
         -->
         <!-- metadata for archive json -->
		<metadata metadata="CatalogIDDigital" field="$.identifier" regularExpression="s/\/aspace\/repositories\/11\/archival_objects\/(.+)/$1/g" docType="volume"  />			
<!--         <metadata metadata="TitleDocMain" field="$.title" /> -->
        <metadata metadata="PublicationYear" field="$.date" />
        <metadata metadata="DocLanguage" field="$.language" />
        <!--  cut 'Eliot, George, 1819-1880' into first- and last name -->
        <person metadata="Author" field="creator" firstname="s/^(.+?)\, (.+?)\, (.+?)$/$2/g" lastname="s/^(.+?)\, (.+?)\, (.+?)$/$1/g" />
        
        <!-- metadata for ils bib json -->
       <metadata metadata="CatalogIDDigital" field="$.children[?(@.itemCount > 1)].children[0].itemId" docType="volume"  />			
       <metadata metadata="CatalogIDDigital" field="$.uri" regularExpression="s/\/ils\/bib\/(.+)/$1/g" docType="anchor"  />      
       
       <metadata metadata="shelfmarksource" field="$.identifierShelfMark" docType="volume" />      
       <metadata metadata="TitleDocMain" field="concat( $.title[0]\,&quot; &quot;\,$.children[0].children[0].sequenceNumber)" docType="volume" />  
       
       <metadata metadata="TitleDocMain" field="$[?(@.children[?(@.itemCount == 1)])].title[0]" docType="volume" />  
     
       <metadata metadata="TitleDocMain" field="$[?(@.children[?(@.itemCount &gt; 1)])].title[0]" docType="anchor" />  
     
    <metadata metadata="OtherTitle"  field="$.alternativeTitle" docType="volume"  />    
    </config>
</config_plugin>
